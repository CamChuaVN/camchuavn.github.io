$(function () {
	// Admin Panel settings

	//****************************
	/* This is for the mini-sidebar if width is less then 1170*/
	//****************************
	var setsidebartype = function () {
		var width =
			window.innerWidth > 0 ? window.innerWidth : this.screen.width;
		if (width < 1199) {
			$("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
			$("#main-wrapper").addClass("mini-sidebar");
		} else {
			$("#main-wrapper").attr("data-sidebartype", "full");
			$("#main-wrapper").removeClass("mini-sidebar");
		}
	};
	$(window).ready(setsidebartype);
	$(window).on("resize", setsidebartype);
	//****************************
	/* This is for sidebartoggler*/
	//****************************
	$(".sidebartoggler").on("click", function () {
		$("#main-wrapper").toggleClass("mini-sidebar");
		if ($("#main-wrapper").hasClass("mini-sidebar")) {
			$(".sidebartoggler").prop("checked", !0);
			$("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
		} else {
			$(".sidebartoggler").prop("checked", !1);
			$("#main-wrapper").attr("data-sidebartype", "full");
		}
	});
	$(".sidebartoggler").on("click", function () {
		$("#main-wrapper").toggleClass("show-sidebar");
	});
});



function setCookie(name, value, days) {
	var expires = '';
	if(days) {
			var date = new Date();
			date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
			expires = '; expires=' + date.toUTCString();
	}
	document.cookie = name + '=' + encodeURIComponent(value) + expires + '; path=/';
}

function getCookie(name) {
	const cookies = document.cookie.split(';');
	for(let i = 0; i < cookies.length; i++) {
			const cookie = cookies[i].trim();
			const eqIdx = cookie.indexOf('=');
			const cookieName = cookie.substr(0, eqIdx);
			if(cookieName === name) {
					const cookieValue = cookie.substr(eqIdx + 1);
					return decodeURIComponent(cookieValue);
			}
	}
	return null;
}

function clearCookie() {
	const cookies = document.cookie.split(";");
	for(let i = 0; i < cookies.length; i++) {
		const cookie = cookies[i];
		const eqPos = cookie.indexOf("=");
		const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
		document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT; domain=.camchua.moe; path=/;";
	}
}


function validateEmail(email) {
	if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)) {
		return true;
	}
	return false;
}


function retrieve(type, data, callback) {
	$.ajax({
		url: "/api/request",
		type: 'post',
		headers: {
			'type': type,
			'token': getCookie('token') | ''
		},
		contentType: 'application/json; charset=utf-8',
		data: JSON.stringify(data),
		success: function(res) {
			callback(res);
		},
		error: function(res) {
			callback(res);
		}
	});
}


let language = {}
$(document).ready(function() {

    retrieve('lang', {}, function(res) {
		if(res.retcode == 0) {
			language = res.data;
			var elementsWithLangAttribute = document.querySelectorAll('[zlang]');
			elementsWithLangAttribute.forEach(function(element) {
				var langAttributeValue = element.getAttribute('zlang');
				element.innerText = language[langAttributeValue];
			});
		}
	});

});
